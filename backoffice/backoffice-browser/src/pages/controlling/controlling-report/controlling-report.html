<div class="top-section">
    <select #controllingSelect class="controlling-selected">
        <option value="CONTROLLING_0100">0100: Heizöl, Treibstoffe (Stichtag 1): Vollständigkeit</option>
        <option value="CONTROLLING_0110">0110: Heizöl, Treibstoffe (Stichtag 1): Preistrend</option>
        <option value="CONTROLLING_0120">0120: Heizöl, Treibstoffe (Stichtag 1): Niveauvergleich nach EP</option>
        <option value="CONTROLLING_0200">0200: Heizöl, Treibstoffe (Stichtag 2): Vollständigkeit</option>
        <option value="CONTROLLING_0210">0210: Heizöl, Treibstoffe (Stichtag 2): Preistrend</option>
        <option value="CONTROLLING_0220">0220: Heizöl, Treibstoffe (Stichtag 2): Niveauvergleich nach EP</option>
        <option value="CONTROLLING_0230">0230: Früchte, Gemüse (Woche 1): Vollständigkeit</option>
        <option value="CONTROLLING_0240">0240: Früchte, Gemüse (Woche 2): Vollständigkeit</option>
        <option value="CONTROLLING_0250">0250: Früchte, Gemüse: Codefehler (0, R, S)</option>
        <option value="CONTROLLING_0300">0300: Bekleidung, Schuhe: Codefehler (7, R, S)</option>
        <option value="CONTROLLING_0310">0310: Bekleidung, Schuhe: gelöschte Preise (Code 0)</option>
        <option value="CONTROLLING_0320">0320: Bekleidung, Schuhe: Ersatz im Ausverkauf (Code 1+A)</option>
        <option value="CONTROLLING_0400">0400: Gelöschte Preise (Code 0, ohne Bekleidung, Früchte, Gemüse)</option>
        <option value="CONTROLLING_0410">0410: Direktersatz mit Aktion (Code 1+A, ohne Bekleidung, Früchte, Gemüse)</option>
        <option value="CONTROLLING_0420">0420: Qualität Ersterfassung: Ersatz (Code 1, 7)</option>
        <option value="CONTROLLING_0430">0430: Qualität Ersterfassung: Neue Artikel (Code 2, 3)</option>
        <option value="CONTROLLING_0440">0440: Neue Artikel: Qualität Ersterfassung (Code 2, 3)</option>
        <option value="CONTROLLING_0500">0500: Ausreisser (-75%/+250%)</option>
        <option value="CONTROLLING_0510">0510: Preisentwicklung auffällig: alle</option>
        <option value="CONTROLLING_0520">0520: Preisentwicklung auffällig: Ersatz (Code 1, 7)</option>
        <option value="CONTROLLING_0530">0530: Preisentwicklung auffällig: Aktionen (A)</option>
        <option value="CONTROLLING_0540">0540: Preisentwicklung auffällig: ohne Aktionen</option>
        <option value="CONTROLLING_0600">0600: Bemerkungen ans BFS</option>
        <option value="CONTROLLING_0700">0700: Preise/EP: Abweichung von Vorgabe (gemäss ES)</option>
    </select>
    <button type="button" ion-button class="btn-execute" (click)="runReport$.emit(controllingSelect.value)">ausführen</button>
    <pef-zoom *ngIf="!!(reportData$ | async)" (zoomLevel)="zoomLevel$.emit($event)"></pef-zoom>
</div>

<div class="table-wrapper" *ngIf="!!(reportData$ | async)">
    <table class="report-table" [pefZoomable]="zoomLevel$ | async">
        <thead>
            <tr>
                <th class="align-right">&nbsp;</th>
                <th *ngFor="let column of (reportData$ | async)?.columns; let i = index" (click)="toggleColumn$.emit(i)" class="collapsable"
                    [class.collapsed]="(hiddenColumns$ | async)[i]">{{ column }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of (reportData$ | async)?.rows">
                <td>
                    <button [class.visibility-hidden]="!row.canView" ion-button class="edit-pm" (click)="editPreismeldungId$.emit(row.pmId)">
                        <pef-icon name="todo"></pef-icon>
                    </button>
                </td>
                <td *ngFor="let value of row.values; let i = index" [class.collapsed]="(hiddenColumns$ | async)[i]">{{ value }}</td>
            </tr>
        </tbody>
    </table>
    <span>&nbsp;</span>
</div>
