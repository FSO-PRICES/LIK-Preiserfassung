<preismeldung-readonly-header [preismeldung]="preismeldung$ | async" [preismeldestelle]="preismeldestelle$ | async" [isAdminApp]="isAdminApp$ | async"></preismeldung-readonly-header>

<ion-content pef-perfect-virtualscroll-scrollbar [enabled]="isDesktop$ | async">
    <form [formGroup]="form" novalidate>
        <div class="detail-tab-bottom-part">
            <h3>{{ 'heading_meine-notiz' | translate }}</h3>
            <ion-item class="pef-textarea-item">
                <ion-textarea formControlName="notiz" (blur)="onBlur$.emit()"></ion-textarea>
            </ion-item>
            <button ion-button color="java" (click)="notizClear$.emit()">{{ 'btn_leeren' | translate }}</button>
            <h3>{{ 'heading_kommentar-zum-aktuellen-monat' | translate }}</h3>
            <div class="kommentar-autotext">
                <span *ngFor="let text of (preismeldung$ | async)?.messages.kommentarAutotext">{{ (text | translate) + '\u0020' }}</span>
            </div>
            <ion-item class="pef-textarea-item">
                <ion-textarea formControlName="kommentar" (blur)="onBlur$.emit()"></ion-textarea>
            </ion-item>
            <button ion-button color="java" (click)="kommentarClear$.emit()">{{ 'btn_leeren' | translate }}</button>
            <h3>{{ 'heading_kommunikation' | translate }}</h3>
            <div class="message-history" *ngIf="(bemerkungenHistory$ | async)?.length > 0">
                <div *ngFor="let h of (bemerkungenHistory$ | async)"><span class="message-author" *ngIf="!!h.author">{{h.author}}:</span>&nbsp;{{h.text}}</div>
            </div>
            <ion-item class="pef-textarea-item">
                <ion-textarea formControlName="bemerkungen" (blur)="onBlur$.emit()" [class.readonly]="erledigtDisabled$ | async" [readonly]="erledigtDisabled$ | async"></ion-textarea>
            </ion-item>
            <button ion-button color="java" [disabled]="erledigtDisabled$ | async" (click)="erledigt$.emit()">{{ 'btn_erledigt' | translate }}</button>
        </div>
    </form>
</ion-content>
