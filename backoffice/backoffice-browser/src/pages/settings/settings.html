<header pef-menu></header>
<div class="page-wrapper">
    <div class="page-content">
        <div class="settings-container container">
            <div class="subcontent">
                <div class="header"><h1 class="large">Einstellungen</h1></div>
                <form
                    [formGroup]="form"
                    class="stacked-form"
                    [class.form-show-validation-hints]="showValidationHints$ | async"
                >
                    <h1 class="large">Serververbindung</h1>
                    <ion-list no-lines>
                        <ion-item class="pef-item" formGroupName="serverConnection">
                            <ion-label stacked>URL</ion-label>
                            <ion-input type="text" formControlName="url"></ion-input>
                        </ion-item>
                        <ion-item class="pef-item" formGroupName="general">
                            <ion-label stacked>Erhebungsorgannummer</ion-label>
                            <ion-input type="text" formControlName="erhebungsorgannummer"></ion-input>
                        </ion-item>
                    </ion-list>
                    <h1 class="large">Transfereinstellungen (Sedex)</h1>
                    <ion-list formGroupName="transportRequestSettings" no-lines>
                        <ion-item class="pef-item">
                            <ion-label stacked>Sender ID</ion-label>
                            <ion-input type="text" formControlName="senderId"></ion-input>
                        </ion-item>
                        <ion-item class="pef-item">
                            <ion-label stacked>Recipient ID</ion-label>
                            <ion-input type="text" formControlName="recipientId"></ion-input>
                        </ion-item>
                    </ion-list>
                    <ion-list formGroupName="export" no-lines>
                        <ion-item class="pef-item">
                            <ion-label stacked>Exportpfad (Sedex-Daten)</ion-label>
                            <ion-input type="text" formControlName="targetPath"></ion-input>
                        </ion-item>
                    </ion-list>
                    <button type="button" ion-button color="blue-chill" (click)="saveClicked$.emit($event)" id="save">
                        Speichern
                    </button>
                    <button type="button" ion-button (click)="cancelClicked$.emit($event)">Abbrechen</button>
                    <h1 class="large"><pef-icon name="warning"></pef-icon>Datenbank Backup/Recovery (CouchDB)</h1>
                    <button ion-button
                        [class.not-shown]="(dangerConfirmed$ | async)"
                        [disabled]="!(canConnectToDatabase$ | async)"
                        type="button"
                        color="danger"
                        (click)="dangerConfirmedClicked$.emit()"
                    >
                        Datenbank Verwaltung anzeigen
                    </button ion-button>
                    <div [class.not-shown]="!(dangerConfirmed$ | async)">
                        <button ion-button type="button" color="blue-chill" (click)="exportDbs$.emit($event)">
                            Export
                        </button ion-button>
                        <button ion-button type="button" (click)="file.click()">
                            Import
                            <input
                                #file
                                class="file-select-btn"
                                type="file"
                                (change)="importFileSelected$.emit($event)"
                                [value]="(resetInput$ | async)?.value"
                                required
                            />
                        </button ion-button>
                    </div>
                    <ion-text *ngIf="(dbsExported$ | async); let dbsExported" color="primary">
                        {{ dbsExported.counts.pe }} Preiserheber und {{ dbsExported.counts.pz }} Preiszuweisungen
                        wurden exportiert.
                    </ion-text>
                    <ion-text *ngIf="(dbImported$ | async); let dbImported" color="primary">
                        {{ dbImported.count }} Eintr√§ge wurden importiert.
                    </ion-text>
                </form>
            </div>
            <div class="about-app">
                <div class="about-box">
                    <h2>LIK PreisAdmin {{ version }}</h2>
                    <span>Autor: <a href="https://lambda-it.ch/">Lambda IT GmbH</a> </span>
                </div>
            </div>
        </div>
    </div>
</div>
